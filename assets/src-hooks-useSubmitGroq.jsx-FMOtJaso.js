import{u as i}from"./pnpm-zustand@4.5.4_@types_react@18.3.3_react@18.3.1--EhdkWrrw.js";import{u as T}from"./src-store-appStore.js-CAdzJ0y8.js";import{u as y}from"./src-store-useChatsStore.js-Da3DW-7L.js";import{u as C}from"./src-store-useSettingsStore.js-nrdVV1X2.js";import{u as x}from"./src-hooks-useOnlineStatus.jsx-6CQSTZAH.js";import{u as F}from"./src-hooks-useUtils.jsx-vDR7zxcx.js";import{sleep as u}from"./src-lib-generateTime.js-DFXwsD9v.js";import{getGroqReply as q}from"./src-controller-groq.js-CncRTy9A.js";import{addNewChatsToFirestore as G}from"./src-controller-CRUDFirestore.js-B7EpQVhr.js";import{u as b}from"./pnpm-react-i18next@15.0.1_i18next@23.12.2_react-dom@18.3.1_react@18.3.1__react@18.3.1--C-fP4VmU.js";const j=()=>{const[n,r]=y(i(e=>[e.setChats,e.getChats])),[l]=C(i(e=>[e.model])),[p,a,c,g,d,m]=T(i(e=>[e.senTyping,e.setSenTyping,e.userId,e.loading,e.setMessageFromUser,e.setGroqFetchProses])),f=x(),{t:h}=b(),S=F();return async(e,o="text")=>{if(o==="text"&&e.trim().length===0||p||g)return;const t={type:o,position:"right",time:new Date().getTime(),message:e};d(""),n([...r(),t]),o==="audio"&&(t.message=e.text,t.downloadUrl=e.downloadUrl,t.audioFileName=e.audioFileName);const s={type:"text",position:"left",time:null,message:null};if(f){await u(1e3),a(!0),m("start");const w=await q(t.message,l,S);s.time=new Date().getTime(),s.message=w,G(c,t,s)}else s.time=new Date().getTime(),s.message=h("senAi_cant_receive_message");a(!1),await u(500),n([...r(),s]),m("end")}};export{j as u};
